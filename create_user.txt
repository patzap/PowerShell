<#
.SYNOPSIS
    Creates a batch of new users with the set parameters 
  

.DESCRIPTION
    Whatever I said above

.PARAMETER Path
    
.PARAMETER LiteralPath

.EXAMPLE
    .\user_creation.ps1 3 test TestOU

.NOTES
    Author: PatZap
    Date: N.A.

#>




Param($NumUsers, $BatchName, $OUlocation
    [String]$Targets = "Help")

Function domain_summary{

    Write-Output "---Domain Summary---"

    Get-Addomain | ForEach-Object {" Name: " + $_.Name + "`n", "Forest: " + $_.Forest + "`n", 
    "DNSRoot: " + $_.DNSRoot + "`n", "Domain Mode: " + $_.DomainMode + "`n",
     "Infrastructure Master: " + $_.InfrastructureMaster + "`n", 
     "Linked GPOs: " + $_.LinkedGroupPolicyObjects}

    Get-ADOrganizationalUnit -Filter 'Name -like "*"' | Format-Table Name, DistinguishedName -A
}

if ($PSBoundParameters.Values.Count -ne 3){

    domain_summary

}else{

    for ($UserNum=1; $UserNum -le $NumUsers; $UserNum++){
    
        New-ADUser -Name $BatchName$UserNum -Path "OU=$OUlocation, DC=zapa0013, DC=local"

    }
    
    
}


 